# Отложить очистку

Используйте функцию отложить для очистки ресурсов, таких как файлы и блокировки.

<table>
<thead><tr><th>Bad</th><th>Good</th></tr></thead>
<tbody>
<tr><td>

```go
p.Lock()
if p.count < 10 {
  p.Unlock()
  return p.count
}

p.count++
newCount := p.count
p.Unlock()

return newCount

// легко пропускаемые разблокировки из-за многократных возвратов
```

</td><td>

```go
p.Lock()
defer p.Unlock()

if p.count < 10 {
  return p.count
}

p.count++
return p.count

// более читабельный
```

</td></tr>
</tbody></table>

При использовании Defer накладные расходы чрезвычайно малы, и их следует избегать, только если вы можете
доказать, что время выполнения вашей функции составляет порядка наносекунд. Преимущество
использования defer в удобочитаемости оправдывает минимальные затраты на их использование. Это
особенно верно для более крупных методов, которые имеют нечто большее, чем простой
доступ к памяти, где другие вычисления более важны, чем "отсрочка`.